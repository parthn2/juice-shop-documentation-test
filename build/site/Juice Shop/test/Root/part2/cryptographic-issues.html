<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cryptographic Issues :: Juice Shop Docs</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Juice Shop Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="Juice Shop" data-version="test">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Juice shop Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Preface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/readme.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/motivation.html">Why OWASP Juice Shop exists</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/architecture.html">Architecture overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part I - Hacking preparations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/README.html">Hacking preparations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/running.html">Running OWASP Juice Shop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/categories.html">Vulnerability categories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/challenges.html">Challenge tracking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/rules.html">Hacking exercise rules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/happy-path.html">Walking the "happy path"</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/customization.html">Customization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/ctf.html">Hosting a CTF event</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part II - Challenge hunting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="README.html">Challenge hunting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="score-board.html">Finding the Score Board</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="injection.html">Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-authentication.html">Broken Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sensitive-data-exposure.html">Sensitive Data Exposure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xxe.html">XML External Entities (XXE)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="improper-input-validation.html">Improper Input Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-access-control.html">Broken Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-misconfiguration.html">Security Misconfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xss.html">Cross Site Scripting (XSS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="insecure-deserialization.html">Insecure Deserialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vulnerable-components.html">Vulnerable Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-through-obscurity.html">Security through Obscurity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="unvalidated-redirects.html">Unvalidated Redirects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-anti-automation.html">Broken Anti-Automation</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="cryptographic-issues.html">Cryptographic Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="miscellaneous.html">Miscellaneous</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part III - Getting involved</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/README.html">Getting involved</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/feedback.html">Provide feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/contribution.html">Contribute to development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/codebase.html">Codebase 101</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/translation.html">Help with translation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/tutorials.html">Hacking Instructor tutorial scripts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/donations.html">Donations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/solutions.html">Challenge solutions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/trainers.html">Trainer&#8217;s guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/cheat-detection.html">Cheat detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/code-snippets.html">Coding challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/integration.html">Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/chatbot.html">Chatbot training data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/lyrics.html">Jingle lyrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Postface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/about.html">About this book</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Juice shop Documentation</span>
    <span class="version">test</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Juice shop Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">test</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Juice shop Documentation</a></li>
    <li>Part II - Challenge hunting</li>
    <li><a href="cryptographic-issues.html">Cryptographic Issues</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///Users/parthnanda/Desktop/development/juice-shop-documentation-test/modules/Root/pages/part2/cryptographic-issues.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Cryptographic Issues</h1>
<div class="sect1">
<h2 id="_challenges_covered_in_this_chapter"><a class="anchor" href="#_challenges_covered_in_this_chapter"></a>Challenges covered in this chapter</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Difficulty</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forged Coupon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forge a coupon code that gives you a discount of at least 80%.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Imaginary Challenge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solve challenge #999. Unfortunately, this challenge does not exist.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nested Easter Egg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apply some advanced cryptanalysis to find <em>the real</em> easter egg.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Premium Paywall</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unlock Premium Challenge to access exclusive content.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Weird Crypto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inform the shop about an algorithm or library it should definitely not use the way it does.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_forge_a_coupon_code_that_gives_you_a_discount_of_at_least_80"><a class="anchor" href="#_forge_a_coupon_code_that_gives_you_a_discount_of_at_least_80"></a>Forge a coupon code that gives you a discount of at least 80%</h3>
<div class="paragraph">
<p>This is probably one of the hardest challenges in the OWASP Juice Shop.
As you learned during <a href="../part1/happy-path.html" class="xref page">the "happy path" tour</a>, the
web shop offers a <em>Coupon</em> field to get a discount on your entire order
during checkout. The challenge is to get a discount of at least 80% on
an order. As no coupons with this high a discount are published, it is
up to you to forge your own.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One viable solution would be to reverse-engineer how coupon codes are
generated and craft your own 80% coupon by using the same (or at least
similar) implementation.</p>
</li>
<li>
<p>Another possible solution might be harvesting as many previous coupon
as possible and look for patterns that might give you a leverage for a
brute force attack.</p>
</li>
<li>
<p>If all else fails, you could still try to blindly brute force the
coupon code field before checkout.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_solve_challenge_999"><a class="anchor" href="#_solve_challenge_999"></a>Solve challenge #999</h3>
<div class="paragraph">
<p>The OWASP Juice Shop is <em>so broken</em> that even its convenience features
(which have nothing to do with the e-commerce use cases) are designed to
be vulnerable. One of these features is
<a href="/part1/challenges.md#automatic-saving-and-restoring-hacking-progress">Automatic saving and restoring hacking progress</a>
after a server crash or a few days pause.</p>
</div>
<div class="paragraph">
<p>In order to not mess with the <em>real challenges</em> accidentally, the
challenge is to fake a signal to the application that you successfully
solved challenge #999 - which does not exist.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find out how saving and restoring progress is done behind the scenes</p>
</li>
<li>
<p>Deduce from all available information (e.g. the <code>package.json.bak</code>)
how the application encrypts and decrypts your hacking progress.</p>
</li>
<li>
<p>Other than the user&#8217;s passwords, the hacking progress involves an
additional secret during its encryption.</p>
</li>
<li>
<p>What would be a <em>really stupid</em> mistake a developer might make when
choosing such a secret?</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apply_some_advanced_cryptanalysis_to_find_the_real_easter_egg"><a class="anchor" href="#_apply_some_advanced_cryptanalysis_to_find_the_real_easter_egg"></a>Apply some advanced cryptanalysis to find the real easter egg</h3>
<div class="paragraph">
<p>Solving the
<a href="broken-access-control.md#find-the-hidden-easter-egg">Find the hidden easter egg</a>
challenge was probably no as satisfying as you had hoped. Now it is time
to tackle the taunt of the developers and hunt down <em>the real</em> easter
egg. This follow-up challenge is basically about finding a secret URL
that - when accessed - will reward you with an easter egg that deserves
the name.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure you solve
<a href="broken-access-control.md#find-the-hidden-easter-egg">Find the hidden easter egg</a>
first.</p>
</li>
<li>
<p>You might have to peel through several layers of tough-as-nails
encryption for this challenge.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_unlock_premium_challenge_to_access_exclusive_content"><a class="anchor" href="#_unlock_premium_challenge_to_access_exclusive_content"></a>Unlock Premium Challenge to access exclusive content</h3>
<div class="paragraph">
<p>These days a lot of seemingly free software comes with hidden or
follow-up costs to use it to its full potential. For example: In
computer games, letting players pay for <em>Downloadable Content</em> (DLC)
after they purchased a full-price game, has become the norm. Often this
is okay, because the developers actually <em>added</em> something worth the
costs to their game. But just as often gamers are supposed to pay for
<em>just unlocking</em> features that were already part of the original
release.</p>
</div>
<div class="paragraph">
<p>This hacking challenge represents the latter kind of "premium" feature.
<em>It only exists to rip you hackers off!</em> Of course you should never
tolerate such a business policy, let alone support it with your precious
Bitcoins!</p>
</div>
<div class="paragraph">
<p>That is why the actual challenge here is to unlock and solve the
"premium" challenge <em>bypassing the paywall</em> in front of it.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is no inappropriate, self-written or misconfigured cryptographic
library to be exploited here.</p>
</li>
<li>
<p>How much protection does a sturdy top-quality door lock add to your
house if you&#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;put the key under the door mat?</p>
</li>
<li>
<p>&#8230;&#8203;hide the key in the nearby plant pot?</p>
</li>
<li>
<p>&#8230;&#8203;tape the key to the underside of the mailbox?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Once more: <strong>You do not have to pay anything to unlock this
challenge!</strong></p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Side note: The Bitcoin address behind the taunting <em>Unlock</em> button is
actually a valid address of the author. So, if you&#8217;d like to donate a
small amount for the ongoing maintenance and development of OWASP
Juice Shop - feel free to actually use it! More on
<a href="../part3/donations.html" class="xref page">donations in part 3</a> of this book.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_inform_the_shop_about_an_algorithm_or_library_it_should_definitely_not_use_the_way_it_does"><a class="anchor" href="#_inform_the_shop_about_an_algorithm_or_library_it_should_definitely_not_use_the_way_it_does"></a>Inform the shop about an algorithm or library it should definitely not use the way it does</h3>
<div class="paragraph">
<p>To fulfil this challenge you must identify a cryptographic algorithm (or
crypto library) that either</p>
</div>
<div class="ulist">
<ul>
<li>
<p>should not be used <em>at all</em></p>
</li>
<li>
<p>or is a <em>bad choice</em> for a given requirement</p>
</li>
<li>
<p>or is used in an <em>insecure way</em>.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Initially confined to the realms of academia and the military,
cryptography has become ubiquitous thanks to the Internet. Common
every day uses of cryptography include mobile phones, passwords, SSL,
smart cards, and DVDs. Cryptography has permeated everyday life, and
is heavily used by many web applications.</p>
</div>
<div class="paragraph">
<p>Cryptography (or crypto) is one of the more advanced topics of
information security, and one whose understanding requires the most
schooling and experience. It is difficult to get right because there
are many approaches to encryption, each with advantages and
disadvantages that need to be thoroughly understood by web solution
architects and developers. In addition, serious cryptography research
is typically based in advanced mathematics and number theory,
providing a serious barrier to entry.</p>
</div>
<div class="paragraph">
<p>The proper and accurate implementation of cryptography is extremely
critical to its efficacy. A small mistake in configuration or coding
will result in removing a large degree of the protection it affords
and rending the crypto implementation useless against serious attacks.</p>
</div>
<div class="paragraph">
<p>A good understanding of crypto is required to be able to discern
between solid products and snake oil. The inherent complexity of
crypto makes it easy to fall for fantastic claims from vendors about
their product. Typically, these are &#8220;a breakthrough in cryptography&#8221;
or &#8220;unbreakable&#8221; or provide "military grade" security. If a vendor
says "trust us, we have had experts look at this,`" chances are they
weren&#8217;t experts!<sup class="footnote" id="_footnote_1">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the <em>Contact Us</em> form to submit a feedback mentioning the abused
algorithm or library.</p>
</li>
<li>
<p>There are five possible answers and you only need to identify one to
solve the challenge.</p>
</li>
<li>
<p>Cryptographic functions only used in the
<a href="#apply-some-advanced-cryptanalysis-to-find-the-real-easter-egg">Apply some advanced cryptanalysis to find the real easter egg</a>
challenge <em>do not count</em> as they are only a developer&#8217;s prank and not
a serious security problem.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://wiki.owasp.org/index.php/Guide_to_Cryptography" class="bare">https://wiki.owasp.org/index.php/Guide_to_Cryptography</a>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
